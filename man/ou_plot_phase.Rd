% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plot_simulate.R
\name{ou_plot_phase}
\alias{ou_plot_phase}
\title{Plot phase portrait}
\usage{
ou_plot_phase(
  x,
  which_dim = NULL,
  which_sim = NULL,
  share_xaxis = TRUE,
  share_yaxis = TRUE,
  palette = "Temps",
  col_theory = "grey30",
  alpha = 1,
  main = "Phase Portrait",
  sub = paste("Dimension", if (is.null(which_dim)) {
    
    seq.int(x[["model"]][["ndim"]])
 } else {
     which_dim
 }),
  xlab = "",
  ylab = "",
  legend_position = "topright",
  ...
)
}
\arguments{
\item{x}{A \code{simulate_affectOU} model object produced by \code{\link[=simulate.affectOU]{simulate.affectOU()}}}

\item{which_dim}{Dimension indices to plot (NULL for all)}

\item{which_sim}{Simulation indices to plot (NULL for all)}

\item{share_xaxis}{Logical; use same x-axis limits for all panels?}

\item{share_yaxis}{Logical; use same y-axis limits for all panels?}

\item{palette}{Color palette. Should be one \code{\link[grDevices:palettes]{grDevices::hcl.pals()}}.}

\item{col_theory}{Color for theoretical relationship line}

\item{alpha}{Alpha transparency for colors (0 = transparent, 1 = opaque)}

\item{main}{Main title}

\item{sub}{Subtitle for panels}

\item{xlab}{X-axis label}

\item{ylab}{Y-axis label}

\item{legend_position}{Position of legend (one of \code{"bottomright"}, \code{"bottom"}, \code{"bottomleft"}, \code{"left"}, \code{"topleft"}, \code{"top"}, \code{"topright"}, \code{"right"}, \code{"center"})}

\item{...}{Additional graphical parameters}
}
\value{
NULL (invisibly), called for side effects only
}
\description{
Visualise the phase portrait of an OU affect simulation. In the case of a 1D
simulation, this plots the lag-1 phase portrait (i.e., dimension at time t
vs. dimension at time t+dt). In the case of multi-dimensional simulations,
this creates a grid of panels: diagonal panels show lag-1 phase portraits for
each dimension, while off-diagonal panels show contemporaneous scatter plots
between pairs of dimensions.
}
\section{Diagonal panels (lag-1 phase portrait)}{

The diagonal panels plot \eqn{X_i(t)} against \eqn{X_i(t + \Delta t)},
showing the relationship between the current and next value of each
dimension. When the system is stable (\eqn{\theta_{ii} > 0}), the
conditional expectation is:
\deqn{E[X_i(t + \Delta t) \mid X_i(t) = x] = \mu_i + (x - \mu_i)e^{-\theta_{ii} \Delta t}}

This is a line through \eqn{(\mu_i, \mu_i)} with slope
\eqn{e^{-\theta_{ii} \Delta t} < 1}. The slope being less than 1 reflects
mean reversion: values above \eqn{\mu_i} are expected to decrease; values
below \eqn{\mu_i} are expected to increase. The star marks the attractor
point \eqn{(\mu_i, \mu_i)}. The theoretical line is only drawn when the
system is stable.
}

\section{Off-diagonal panels (contemporaneous scatter)}{

The off-diagonal panels plot \eqn{X_i(t)} against \eqn{X_j(t)} at the same
time point, showing the joint distribution of dimensions \eqn{i} and
\eqn{j}. When the system is stable, the conditional expectation based on
the stationary covariance \eqn{\Gamma_\infty} is:
\deqn{E[X_j \mid X_i = x] = \mu_j + \frac{\Gamma_{\infty,ij}}{\Gamma_{\infty,ii}}(x - \mu_i)}

This is a regression line through \eqn{(\mu_i, \mu_j)} with slope determined
by the stationary covariance structure. The theoretical line is only drawn
when the system is stable.
}

\examples{
model <- affectOU(ndim = 2)
sim <- simulate(model, nsim = 3)
ou_plot_phase(sim)

# Mean reversion visible in slope < 1
model <- affectOU(theta = 0.5, mu = 0, gamma = 1)
sim <- simulate(model, stop = 100, dt = 0.01, save_at = 0.1)
ou_plot_phase(sim) # slope = exp(-0.5 * 0.1) = 0.95
}
